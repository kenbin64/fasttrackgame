<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Supercharger | ButterflyFX</title>
    <style>
        :root {
            --bg: #050508;
            --bg-card: rgba(18, 18, 28, 0.9);
            --text: #ffffff;
            --text-dim: #a0a8c0;
            --neon-green: #00ff88;
            --neon-cyan: #00d4ff;
            --neon-purple: #9b6dff;
            --border: rgba(0, 255, 136, 0.3);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            padding: 20px;
        }
        .container { max-width: 1400px; margin: 0 auto; }
        header { text-align: center; padding: 30px 0; }
        h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--neon-green), var(--neon-cyan));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        .tagline { color: var(--text-dim); font-size: 1.1rem; }
        .workspace {
            display: grid;
            grid-template-columns: 250px 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        .panel {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 20px;
        }
        .panel h2 {
            font-size: 1rem;
            margin-bottom: 15px;
            color: var(--neon-cyan);
        }
        .image-container {
            position: relative;
            width: 100%;
            aspect-ratio: 4/3;
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .image-container img, .image-container canvas {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        .drop-zone {
            border: 2px dashed var(--border);
            border-radius: 12px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        .drop-zone:hover, .drop-zone.dragover {
            border-color: var(--neon-green);
            background: rgba(0,255,136,0.1);
        }
        .slider-group {
            margin-bottom: 20px;
        }
        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }
        .slider-value { color: var(--neon-green); font-weight: 600; }
        input[type="range"] {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: rgba(255,255,255,0.1);
            outline: none;
            -webkit-appearance: none;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--neon-green);
            cursor: pointer;
        }
        .presets {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }
        .preset-btn {
            padding: 8px 12px;
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border);
            border-radius: 20px;
            color: var(--text);
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .preset-btn:hover {
            border-color: var(--neon-green);
            background: rgba(0,255,136,0.1);
        }
        .preset-btn.active {
            background: var(--neon-green);
            color: var(--bg);
        }
        .action-btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 10px;
            transition: all 0.3s;
        }
        .btn-primary {
            background: linear-gradient(135deg, var(--neon-green), var(--neon-cyan));
            color: var(--bg);
        }
        .btn-primary:hover { transform: translateY(-2px); }
        .btn-secondary {
            background: transparent;
            border: 2px solid var(--border);
            color: var(--text);
        }
        .btn-secondary:hover { border-color: var(--neon-green); }
        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
            padding: 15px;
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            font-size: 0.85rem;
        }
        .stat-item { display: flex; justify-content: space-between; }
        .stat-value { color: var(--neon-green); }
        .comparison-slider {
            position: absolute;
            top: 0;
            left: 50%;
            width: 4px;
            height: 100%;
            background: var(--neon-green);
            cursor: ew-resize;
            z-index: 10;
        }
        .comparison-slider::before {
            content: '‚ü∑';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--neon-green);
            color: var(--bg);
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: var(--text-dim);
            text-decoration: none;
        }
        .back-link:hover { color: var(--neon-green); }
        @media (max-width: 900px) {
            .workspace { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="/superchargers" class="back-link">‚Üê Back to Superchargers</a>
        
        <header>
            <h1>üñºÔ∏è Image Supercharger</h1>
            <p class="tagline">AI-powered enhancement ‚Äî sharpen, upscale, color correct in one click</p>
        </header>
        
        <div class="workspace">
            <div class="panel">
                <h2>üé® Enhancements</h2>
                
                <div class="presets">
                    <button class="preset-btn" onclick="applyPreset('auto')">‚ú® Auto Enhance</button>
                    <button class="preset-btn" onclick="applyPreset('vivid')">üåà Vivid</button>
                    <button class="preset-btn" onclick="applyPreset('portrait')">üë§ Portrait</button>
                    <button class="preset-btn" onclick="applyPreset('landscape')">üèîÔ∏è Landscape</button>
                    <button class="preset-btn" onclick="applyPreset('vintage')">üì∑ Vintage</button>
                    <button class="preset-btn" onclick="applyPreset('bw')">‚ö´ B&W</button>
                </div>
                
                <div class="slider-group">
                    <div class="slider-label">
                        <span>Brightness</span>
                        <span class="slider-value" id="brightnessVal">100%</span>
                    </div>
                    <input type="range" id="brightness" min="50" max="150" value="100" oninput="updateSlider('brightness')">
                </div>
                
                <div class="slider-group">
                    <div class="slider-label">
                        <span>Contrast</span>
                        <span class="slider-value" id="contrastVal">100%</span>
                    </div>
                    <input type="range" id="contrast" min="50" max="150" value="100" oninput="updateSlider('contrast')">
                </div>
                
                <div class="slider-group">
                    <div class="slider-label">
                        <span>Saturation</span>
                        <span class="slider-value" id="saturationVal">100%</span>
                    </div>
                    <input type="range" id="saturation" min="0" max="200" value="100" oninput="updateSlider('saturation')">
                </div>
                
                <div class="slider-group">
                    <div class="slider-label">
                        <span>Sharpness</span>
                        <span class="slider-value" id="sharpnessVal">0%</span>
                    </div>
                    <input type="range" id="sharpness" min="0" max="100" value="0" oninput="updateSlider('sharpness')">
                </div>
                
                <div class="slider-group">
                    <div class="slider-label">
                        <span>Noise Reduction</span>
                        <span class="slider-value" id="denoiseVal">0%</span>
                    </div>
                    <input type="range" id="denoise" min="0" max="100" value="0" oninput="updateSlider('denoise')">
                </div>
                
                <div class="slider-group">
                    <div class="slider-label">
                        <span>Upscale</span>
                        <span class="slider-value" id="upscaleVal">1x</span>
                    </div>
                    <input type="range" id="upscale" min="1" max="4" value="1" step="1" oninput="updateSlider('upscale')">
                </div>
                
                <button class="action-btn btn-primary" onclick="applyEnhancements()">‚ö° Apply Enhancements</button>
                <button class="action-btn btn-secondary" onclick="resetSliders()">‚Ü©Ô∏è Reset</button>
                <button class="action-btn btn-secondary" onclick="downloadImage()">‚¨áÔ∏è Download</button>
                
                <div class="stats" id="stats" style="display: none;">
                    <div class="stat-item">
                        <span>Original:</span>
                        <span class="stat-value" id="origSize">-</span>
                    </div>
                    <div class="stat-item">
                        <span>Enhanced:</span>
                        <span class="stat-value" id="newSize">-</span>
                    </div>
                    <div class="stat-item">
                        <span>Process time:</span>
                        <span class="stat-value" id="processTime">-</span>
                    </div>
                    <div class="stat-item">
                        <span>Upscale:</span>
                        <span class="stat-value" id="upscaleStat">-</span>
                    </div>
                </div>
            </div>
            
            <div class="panel">
                <h2>üì∑ Original</h2>
                <div class="image-container" id="originalContainer">
                    <div class="drop-zone" id="dropZone">
                        <p style="font-size: 2rem; margin-bottom: 10px;">üìÅ</p>
                        <p>Drop an image here</p>
                        <p style="font-size: 0.8rem; color: var(--text-dim); margin-top: 10px;">or click to browse</p>
                        <input type="file" id="fileInput" accept="image/*" style="display: none;">
                    </div>
                    <img id="originalImage" style="display: none;">
                </div>
            </div>
            
            <div class="panel">
                <h2>‚ú® Enhanced</h2>
                <div class="image-container">
                    <canvas id="enhancedCanvas"></canvas>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        const dropZone = document.getElementById('dropZone');
        const fileInput = document.getElementById('fileInput');
        const originalImage = document.getElementById('originalImage');
        const enhancedCanvas = document.getElementById('enhancedCanvas');
        const ctx = enhancedCanvas.getContext('2d');
        
        let imageLoaded = false;
        
        // File handling
        dropZone.addEventListener('click', () => fileInput.click());
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('dragover');
        });
        dropZone.addEventListener('dragleave', () => dropZone.classList.remove('dragover'));
        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('dragover');
            handleFile(e.dataTransfer.files[0]);
        });
        fileInput.addEventListener('change', (e) => handleFile(e.target.files[0]));
        
        function handleFile(file) {
            if (!file || !file.type.startsWith('image/')) return;
            
            const reader = new FileReader();
            reader.onload = (e) => {
                originalImage.src = e.target.result;
                originalImage.onload = () => {
                    dropZone.style.display = 'none';
                    originalImage.style.display = 'block';
                    imageLoaded = true;
                    
                    // Set canvas size
                    enhancedCanvas.width = originalImage.naturalWidth;
                    enhancedCanvas.height = originalImage.naturalHeight;
                    ctx.drawImage(originalImage, 0, 0);
                    
                    document.getElementById('origSize').textContent = 
                        `${originalImage.naturalWidth}√ó${originalImage.naturalHeight}`;
                    document.getElementById('stats').style.display = 'grid';
                };
            };
            reader.readAsDataURL(file);
        }
        
        function updateSlider(name) {
            const value = document.getElementById(name).value;
            const suffix = name === 'upscale' ? 'x' : '%';
            document.getElementById(name + 'Val').textContent = value + suffix;
        }
        
        function applyPreset(preset) {
            document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            
            const presets = {
                auto: { brightness: 105, contrast: 110, saturation: 115, sharpness: 25, denoise: 10, upscale: 1 },
                vivid: { brightness: 100, contrast: 120, saturation: 150, sharpness: 30, denoise: 0, upscale: 1 },
                portrait: { brightness: 105, contrast: 95, saturation: 90, sharpness: 15, denoise: 20, upscale: 1 },
                landscape: { brightness: 100, contrast: 115, saturation: 130, sharpness: 40, denoise: 5, upscale: 1 },
                vintage: { brightness: 95, contrast: 110, saturation: 70, sharpness: 0, denoise: 0, upscale: 1 },
                bw: { brightness: 100, contrast: 120, saturation: 0, sharpness: 20, denoise: 0, upscale: 1 }
            };
            
            const p = presets[preset];
            Object.keys(p).forEach(key => {
                document.getElementById(key).value = p[key];
                updateSlider(key);
            });
            
            if (imageLoaded) applyEnhancements();
        }
        
        function resetSliders() {
            ['brightness', 'contrast', 'saturation'].forEach(s => {
                document.getElementById(s).value = 100;
                updateSlider(s);
            });
            ['sharpness', 'denoise'].forEach(s => {
                document.getElementById(s).value = 0;
                updateSlider(s);
            });
            document.getElementById('upscale').value = 1;
            updateSlider('upscale');
            document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
            
            if (imageLoaded) {
                ctx.drawImage(originalImage, 0, 0);
            }
        }
        
        function applyEnhancements() {
            if (!imageLoaded) {
                alert('Please load an image first');
                return;
            }
            
            const startTime = performance.now();
            
            const brightness = document.getElementById('brightness').value / 100;
            const contrast = document.getElementById('contrast').value / 100;
            const saturation = document.getElementById('saturation').value / 100;
            const sharpness = document.getElementById('sharpness').value / 100;
            const denoise = document.getElementById('denoise').value / 100;
            const upscale = parseInt(document.getElementById('upscale').value);
            
            // Set canvas size with upscale
            const newWidth = originalImage.naturalWidth * upscale;
            const newHeight = originalImage.naturalHeight * upscale;
            enhancedCanvas.width = newWidth;
            enhancedCanvas.height = newHeight;
            
            // Draw upscaled image
            ctx.imageSmoothingEnabled = true;
            ctx.imageSmoothingQuality = 'high';
            ctx.drawImage(originalImage, 0, 0, newWidth, newHeight);
            
            // Get image data
            let imageData = ctx.getImageData(0, 0, newWidth, newHeight);
            let data = imageData.data;
            
            // Apply brightness, contrast, saturation
            for (let i = 0; i < data.length; i += 4) {
                let r = data[i], g = data[i+1], b = data[i+2];
                
                // Brightness
                r *= brightness;
                g *= brightness;
                b *= brightness;
                
                // Contrast
                r = ((r / 255 - 0.5) * contrast + 0.5) * 255;
                g = ((g / 255 - 0.5) * contrast + 0.5) * 255;
                b = ((b / 255 - 0.5) * contrast + 0.5) * 255;
                
                // Saturation
                const gray = 0.2989 * r + 0.587 * g + 0.114 * b;
                r = gray + saturation * (r - gray);
                g = gray + saturation * (g - gray);
                b = gray + saturation * (b - gray);
                
                data[i] = Math.min(255, Math.max(0, r));
                data[i+1] = Math.min(255, Math.max(0, g));
                data[i+2] = Math.min(255, Math.max(0, b));
            }
            
            // Apply denoise (simple blur for noise reduction)
            if (denoise > 0) {
                const blurRadius = Math.round(denoise * 3);
                // Simple box blur
                const tempData = new Uint8ClampedArray(data);
                for (let y = blurRadius; y < newHeight - blurRadius; y++) {
                    for (let x = blurRadius; x < newWidth - blurRadius; x++) {
                        let rSum = 0, gSum = 0, bSum = 0, count = 0;
                        for (let dy = -blurRadius; dy <= blurRadius; dy++) {
                            for (let dx = -blurRadius; dx <= blurRadius; dx++) {
                                const idx = ((y + dy) * newWidth + (x + dx)) * 4;
                                rSum += tempData[idx];
                                gSum += tempData[idx + 1];
                                bSum += tempData[idx + 2];
                                count++;
                            }
                        }
                        const idx = (y * newWidth + x) * 4;
                        const blend = denoise * 0.5;
                        data[idx] = data[idx] * (1 - blend) + (rSum / count) * blend;
                        data[idx + 1] = data[idx + 1] * (1 - blend) + (gSum / count) * blend;
                        data[idx + 2] = data[idx + 2] * (1 - blend) + (bSum / count) * blend;
                    }
                }
            }
            
            // Apply sharpness (unsharp mask)
            if (sharpness > 0) {
                const tempData = new Uint8ClampedArray(data);
                const amount = sharpness * 2;
                for (let y = 1; y < newHeight - 1; y++) {
                    for (let x = 1; x < newWidth - 1; x++) {
                        const idx = (y * newWidth + x) * 4;
                        for (let c = 0; c < 3; c++) {
                            const center = tempData[idx + c];
                            const neighbors = (
                                tempData[((y-1) * newWidth + x) * 4 + c] +
                                tempData[((y+1) * newWidth + x) * 4 + c] +
                                tempData[(y * newWidth + x-1) * 4 + c] +
                                tempData[(y * newWidth + x+1) * 4 + c]
                            ) / 4;
                            data[idx + c] = Math.min(255, Math.max(0, center + amount * (center - neighbors)));
                        }
                    }
                }
            }
            
            ctx.putImageData(imageData, 0, 0);
            
            const endTime = performance.now();
            
            // Update stats
            document.getElementById('newSize').textContent = `${newWidth}√ó${newHeight}`;
            document.getElementById('processTime').textContent = `${(endTime - startTime).toFixed(0)}ms`;
            document.getElementById('upscaleStat').textContent = `${upscale}x`;
        }
        
        function downloadImage() {
            if (!imageLoaded) {
                alert('Please load and enhance an image first');
                return;
            }
            
            const link = document.createElement('a');
            link.download = 'enhanced-image.png';
            link.href = enhancedCanvas.toDataURL('image/png');
            link.click();
        }
        
        // Load demo image
        originalImage.crossOrigin = 'anonymous';
        originalImage.onload = () => {
            dropZone.style.display = 'none';
            originalImage.style.display = 'block';
            imageLoaded = true;
            enhancedCanvas.width = originalImage.naturalWidth;
            enhancedCanvas.height = originalImage.naturalHeight;
            ctx.drawImage(originalImage, 0, 0);
            document.getElementById('origSize').textContent = 
                `${originalImage.naturalWidth}√ó${originalImage.naturalHeight}`;
            document.getElementById('stats').style.display = 'grid';
        };
        // Demo with placeholder
        originalImage.src = 'data:image/svg+xml,' + encodeURIComponent(`
            <svg xmlns="http://www.w3.org/2000/svg" width="800" height="600">
                <defs>
                    <linearGradient id="sky" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#1a1a3e"/>
                        <stop offset="100%" style="stop-color:#4a3080"/>
                    </linearGradient>
                </defs>
                <rect fill="url(#sky)" width="800" height="600"/>
                <circle cx="650" cy="100" r="60" fill="#ffe066"/>
                <rect fill="#2d5016" x="0" y="400" width="800" height="200"/>
                <polygon fill="#1a3d0c" points="100,400 200,250 300,400"/>
                <polygon fill="#234d14" points="250,400 400,200 550,400"/>
                <polygon fill="#1a3d0c" points="500,400 650,280 800,400"/>
                <text x="400" y="500" text-anchor="middle" fill="#fff" font-size="24" font-family="Arial">Demo Landscape - Drop your image!</text>
            </svg>
        `);
    </script>
</body>
</html>
